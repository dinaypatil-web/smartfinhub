import{r as i,j as t,O as Ie,P as we,Q as re,U as Se,V as ue,Y as oe,Z as Ae,N as De,z as Te,x as Me,u as Fe,E as Be,d as Pe,_ as Le,t as J,k as O,A as ee,B as te,C as Re,e as Oe,f as qe,h as $e,L as E,I as K,$ as X,a0 as Y,M as ae}from"./index-CadMXyJB.js";import{T as Ue}from"./textarea-DkNO1uRR.js";import{u as Ve,e as ze,C as He,S as q,a as $,b as U,c as V,d as f}from"./select-BtuBbjBO.js";import{f as S}from"./format-RllGV7dv.js";import{f as We,h as Ge,i as Ke,v as de,j as le}from"./statementCalculations-BIN_tZQj.js";import{I as Xe}from"./incomeCategories-h_Agwvah.js";import{c as me}from"./cache-SNmVlzwA.js";import{A as Ye}from"./arrow-left-DK6e-IDk.js";import{T as Qe}from"./trending-down-7vN5W4-d.js";import{C as ne}from"./credit-card-CLQXqH6e.js";import"./chevron-up-DrbdFayN.js";import"./countries-BGn44Cmt.js";var Q="Checkbox",[Ze,_t]=Ie(Q),[Je,se]=Ze(Q);function et(s){const{__scopeCheckbox:x,checked:o,children:b,defaultChecked:c,disabled:m,form:j,name:N,onCheckedChange:v,required:h,value:I="on",internal_do_not_use_render:g}=s,[C,d]=Se({prop:o,defaultProp:c??!1,onChange:v,caller:Q}),[k,A]=i.useState(null),[D,e]=i.useState(null),l=i.useRef(!1),w=k?!!j||!!k.closest("form"):!0,M={checked:C,disabled:m,setChecked:d,control:k,setControl:A,name:N,form:j,value:I,hasConsumerStoppedPropagationRef:l,required:h,defaultChecked:T(c)?!1:c,isFormControl:w,bubbleInput:D,setBubbleInput:e};return t.jsx(Je,{scope:x,...M,children:tt(g)?g(M):b})}var pe="CheckboxTrigger",he=i.forwardRef(({__scopeCheckbox:s,onKeyDown:x,onClick:o,...b},c)=>{const{control:m,value:j,disabled:N,checked:v,required:h,setControl:I,setChecked:g,hasConsumerStoppedPropagationRef:C,isFormControl:d,bubbleInput:k}=se(pe,s),A=ue(c,I),D=i.useRef(v);return i.useEffect(()=>{const e=m==null?void 0:m.form;if(e){const l=()=>g(D.current);return e.addEventListener("reset",l),()=>e.removeEventListener("reset",l)}},[m,g]),t.jsx(re.button,{type:"button",role:"checkbox","aria-checked":T(v)?"mixed":v,"aria-required":h,"data-state":be(v),"data-disabled":N?"":void 0,disabled:N,value:j,...b,ref:A,onKeyDown:oe(x,e=>{e.key==="Enter"&&e.preventDefault()}),onClick:oe(o,e=>{g(l=>T(l)?!0:!l),k&&d&&(C.current=e.isPropagationStopped(),C.current||e.stopPropagation())})})});he.displayName=pe;var _e=i.forwardRef((s,x)=>{const{__scopeCheckbox:o,name:b,checked:c,defaultChecked:m,required:j,disabled:N,value:v,onCheckedChange:h,form:I,...g}=s;return t.jsx(et,{__scopeCheckbox:o,checked:c,defaultChecked:m,disabled:N,required:j,onCheckedChange:h,name:b,form:I,value:v,internal_do_not_use_render:({isFormControl:C})=>t.jsxs(t.Fragment,{children:[t.jsx(he,{...g,ref:x,__scopeCheckbox:o}),C&&t.jsx(ye,{__scopeCheckbox:o})]})})});_e.displayName=Q;var xe="CheckboxIndicator",fe=i.forwardRef((s,x)=>{const{__scopeCheckbox:o,forceMount:b,...c}=s,m=se(xe,o);return t.jsx(we,{present:b||T(m.checked)||m.checked===!0,children:t.jsx(re.span,{"data-state":be(m.checked),"data-disabled":m.disabled?"":void 0,...c,ref:x,style:{pointerEvents:"none",...s.style}})})});fe.displayName=xe;var ge="CheckboxBubbleInput",ye=i.forwardRef(({__scopeCheckbox:s,...x},o)=>{const{control:b,hasConsumerStoppedPropagationRef:c,checked:m,defaultChecked:j,required:N,disabled:v,name:h,value:I,form:g,bubbleInput:C,setBubbleInput:d}=se(ge,s),k=ue(o,d),A=Ve(m),D=ze(b);i.useEffect(()=>{const l=C;if(!l)return;const w=window.HTMLInputElement.prototype,R=Object.getOwnPropertyDescriptor(w,"checked").set,B=!c.current;if(A!==m&&R){const F=new Event("click",{bubbles:B});l.indeterminate=T(m),R.call(l,T(m)?!1:m),l.dispatchEvent(F)}},[C,A,m,c]);const e=i.useRef(T(m)?!1:m);return t.jsx(re.input,{type:"checkbox","aria-hidden":!0,defaultChecked:j??e.current,required:N,disabled:v,name:h,value:I,form:g,...x,tabIndex:-1,ref:k,style:{...x.style,...D,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});ye.displayName=ge;function tt(s){return typeof s=="function"}function T(s){return s==="indeterminate"}function be(s){return T(s)?"indeterminate":s?"checked":"unchecked"}function at({className:s,...x}){return t.jsx(_e,{"data-slot":"checkbox",className:Ae("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...x,children:t.jsx(fe,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:t.jsx(He,{className:"size-3.5"})})})}function xt(){var ie,ce;const{id:s}=De(),x=Te(),{user:o,profile:b}=Me(),{toast:c}=Fe(),[m,j]=i.useState(!1),[N,v]=i.useState(!0),[h,I]=i.useState([]),[g,C]=i.useState([]),[d,k]=i.useState(null),[A,D]=i.useState(!1),[e,l]=i.useState({transaction_type:"expense",from_account_id:"",to_account_id:"",amount:"",currency:(b==null?void 0:b.default_currency)||"INR",category:"",income_category:"",description:"",transaction_date:new Date().toISOString().split("T")[0],is_emi:!1,emi_months:"",bank_charges:""}),[w,M]=i.useState(null),[R,B]=i.useState(null),[F,Z]=i.useState(null),[P,ve]=i.useState(null),[z,je]=i.useState(0),[H,Ce]=i.useState(null);i.useEffect(()=>{o&&Ne()},[o]),i.useEffect(()=>{if(e.from_account_id&&e.transaction_date&&!e.is_emi){const a=h.find(r=>r.id===e.from_account_id);if(a&&a.account_type==="credit_card"&&a.statement_day&&a.due_day){const r=new Date(e.transaction_date),{statementDate:u,dueDate:n}=We(a.statement_day,a.due_day,r);Z({statementDate:u,dueDate:n})}else Z(null)}else Z(null)},[e.from_account_id,e.transaction_date,e.is_emi,h]),i.useEffect(()=>{if(e.transaction_type==="loan_payment"){const a=g.find(r=>r.name==="Loan repayments");a&&e.category!==a.name&&l(r=>({...r,category:a.name}))}},[e.transaction_type,g]),i.useEffect(()=>{o&&e.category&&(e.transaction_type==="expense"||e.transaction_type==="loan_payment")&&e.transaction_date?ke():k(null)},[o,e.category,e.transaction_type,e.transaction_date]),i.useEffect(()=>{if(e.is_emi&&e.amount&&e.emi_months&&e.bank_charges){const a=parseFloat(e.amount),r=parseInt(e.emi_months),u=parseFloat(e.bank_charges);if(!isNaN(a)&&!isNaN(r)&&!isNaN(u)&&r>0){const n=Ge(a,u,r);M(n)}else M(null)}else M(null)},[e.is_emi,e.amount,e.emi_months,e.bank_charges]),i.useEffect(()=>{if(e.from_account_id&&e.amount){const a=h.find(r=>r.id===e.from_account_id);if(a&&a.account_type==="credit_card"){const r=parseFloat(e.amount);if(!isNaN(r)){const u=e.from_account_id===H,n=s&&u?a.balance-z:a.balance,p=n+r,_=Ke(p,a.credit_limit,a.currency);B(_);const y=de(n,r,a.credit_limit);y.valid||B(`⚠️ ${y.message}`)}}else B(null)}else B(null)},[e.from_account_id,e.amount,h,s,z,H]);const ke=async()=>{if(!(!o||!e.category||e.transaction_type!=="expense")){D(!0);try{const a=new Date(e.transaction_date),r=a.getMonth()+1,u=a.getFullYear(),n=await Be.getCategoryBudgetInfo(o.id,e.category,r,u);k(n)}catch(a){console.error("Error loading budget info:",a),k(null)}finally{D(!1)}}},Ne=async()=>{if(o){v(!0);try{const[a,r]=await Promise.all([Pe.getAccounts(o.id),Le.getCategories(o.id)]);if(I(a),C(r),s){const n=(await J.getTransactions(o.id)).find(p=>p.id===s);if(n){let p=null;if(n.from_account_id){const _=a.find(y=>y.id===n.from_account_id);_&&_.account_type==="credit_card"&&(p=await O.getEMIByTransactionId(n.id))}ve(p),je(Number(n.amount)),Ce(n.from_account_id),l({transaction_type:n.transaction_type,from_account_id:n.from_account_id||"",to_account_id:n.to_account_id||"",amount:n.amount.toString(),currency:n.currency,category:n.category||"",income_category:n.income_category||"",description:n.description||"",transaction_date:n.transaction_date,is_emi:!!p,emi_months:p?p.emi_months.toString():"",bank_charges:p?p.bank_charges.toString():""})}}}catch(a){console.error("Error loading data:",a),c({title:"Error",description:"Failed to load data",variant:"destructive"})}finally{v(!1)}}},Ee=async a=>{if(a.preventDefault(),!o)return;if(!e.amount||parseFloat(e.amount)<=0){c({title:"Error",description:"Please enter a valid amount",variant:"destructive"});return}const r=parseFloat(e.amount);if(isNaN(r)||r<=0){c({title:"Error",description:"Amount must be a positive number",variant:"destructive"});return}if(e.transaction_type==="income"&&!e.to_account_id){c({title:"Error",description:"Please select a destination account for income",variant:"destructive"});return}if(e.transaction_type==="expense"&&!e.from_account_id){c({title:"Error",description:"Please select a source account for expense",variant:"destructive"});return}if((e.transaction_type==="transfer"||e.transaction_type==="withdrawal")&&(!e.from_account_id||!e.to_account_id)){c({title:"Error",description:"Please select both source and destination accounts",variant:"destructive"});return}if(e.transaction_type==="loan_payment"&&(!e.from_account_id||!e.to_account_id)){c({title:"Error",description:"Please select both payment source and loan account",variant:"destructive"});return}if(e.transaction_type==="credit_card_repayment"&&(!e.from_account_id||!e.to_account_id)){c({title:"Error",description:"Please select both payment source and credit card account",variant:"destructive"});return}if(e.is_emi){if(!e.emi_months||parseInt(e.emi_months)<=0){c({title:"Error",description:"Please enter valid EMI duration",variant:"destructive"});return}if(!e.bank_charges||parseFloat(e.bank_charges)<0){c({title:"Error",description:"Please enter valid bank charges",variant:"destructive"});return}}if(e.from_account_id){const u=h.find(n=>n.id===e.from_account_id);if(u&&u.account_type==="credit_card"&&u.credit_limit){const n=e.from_account_id===H,p=s&&n?u.balance-z:u.balance,_=de(p,parseFloat(e.amount),u.credit_limit);if(!_.valid){c({title:"Credit Limit Exceeded",description:_.message,variant:"destructive"});return}}}j(!0);try{const u={user_id:o.id,transaction_type:e.transaction_type,from_account_id:e.from_account_id||null,to_account_id:e.to_account_id||null,amount:parseFloat(e.amount),currency:e.currency,category:e.category||null,income_category:e.income_category||null,description:e.description||null,transaction_date:e.transaction_date};let n=null;if(s){if(await J.updateTransaction(s,u),e.is_emi){const p=parseFloat(e.amount),_=parseFloat(e.bank_charges),y=parseInt(e.emi_months),W=le(p,_,y),L=p+_,G={user_id:o.id,account_id:e.from_account_id,transaction_id:s,purchase_amount:p,bank_charges:_,total_amount:L,emi_months:y,monthly_emi:W,remaining_installments:P?P.remaining_installments:y,start_date:e.transaction_date,next_due_date:e.transaction_date,description:e.description||`EMI for ${e.category||"purchase"}`,status:"active"};P?await O.updateEMI(P.id,G):await O.createEMI(G)}else P&&await O.deleteEMI(P.id);me.clearPattern("dashboard-"),c({title:"Success",description:"Transaction updated successfully"})}else{if(n=await J.createTransaction(u),e.is_emi&&n){const p=parseFloat(e.amount),_=parseFloat(e.bank_charges),y=parseInt(e.emi_months),W=le(p,_,y),L=p+_,G={user_id:o.id,account_id:e.from_account_id,transaction_id:n.id,purchase_amount:p,bank_charges:_,total_amount:L,emi_months:y,monthly_emi:W,remaining_installments:y,start_date:e.transaction_date,next_due_date:e.transaction_date,description:e.description||`EMI for ${e.category||"purchase"}`,status:"active"};await O.createEMI(G)}me.clearPattern("dashboard-"),c({title:"Success",description:e.is_emi?"Transaction and EMI created successfully":"Transaction created successfully"})}x("/transactions")}catch(u){console.error("Error saving transaction:",u),c({title:"Error",description:u.message||"Failed to save transaction",variant:"destructive"})}finally{j(!1)}};return N?t.jsx("div",{className:"container mx-auto p-6 flex items-center justify-center min-h-[400px]",children:t.jsx(ee,{className:"h-8 w-8 animate-spin text-primary"})}):t.jsxs("div",{className:"container mx-auto p-6 max-w-2xl",children:[t.jsxs(te,{variant:"ghost",onClick:()=>x("/transactions"),className:"mb-4",children:[t.jsx(Ye,{className:"mr-2 h-4 w-4"}),"Back to Transactions"]}),t.jsxs(Re,{children:[t.jsx(Oe,{children:t.jsx(qe,{children:s?"Edit Transaction":"Add New Transaction"})}),t.jsx($e,{children:t.jsxs("form",{onSubmit:Ee,className:"space-y-6",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(E,{htmlFor:"transaction_type",children:"Transaction Type *"}),t.jsxs(q,{value:e.transaction_type,onValueChange:a=>l({...e,transaction_type:a}),children:[t.jsx($,{children:t.jsx(U,{})}),t.jsxs(V,{children:[t.jsx(f,{value:"income",children:"Income"}),t.jsx(f,{value:"expense",children:"Expense"}),t.jsx(f,{value:"withdrawal",children:"Withdrawal"}),t.jsx(f,{value:"transfer",children:"Transfer"}),t.jsx(f,{value:"loan_payment",children:"Loan Payment"}),t.jsx(f,{value:"credit_card_repayment",children:"Credit Card Repayment"})]})]})]}),(e.transaction_type==="expense"||e.transaction_type==="withdrawal"||e.transaction_type==="transfer"||e.transaction_type==="loan_payment"||e.transaction_type==="credit_card_repayment")&&t.jsxs("div",{className:"space-y-2",children:[t.jsx(E,{htmlFor:"from_account_id",children:e.transaction_type==="withdrawal"?"From Bank/Credit Card *":e.transaction_type==="credit_card_repayment"?"From Bank Account *":"From Account *"}),t.jsxs(q,{value:e.from_account_id,onValueChange:a=>l({...e,from_account_id:a}),children:[t.jsx($,{children:t.jsx(U,{placeholder:"Select account"})}),t.jsx(V,{children:e.transaction_type==="withdrawal"?h.filter(a=>a.account_type==="bank"||a.account_type==="credit_card").map(a=>t.jsxs(f,{value:a.id,children:[a.account_name," (",a.account_type,")"]},a.id)):e.transaction_type==="credit_card_repayment"?h.filter(a=>a.account_type==="bank"||a.account_type==="cash").map(a=>t.jsx(f,{value:a.id,children:a.account_name},a.id)):h.filter(a=>a.account_type!=="loan").map(a=>t.jsxs(f,{value:a.id,children:[a.account_name," (",a.account_type,")"]},a.id))})]}),e.from_account_id&&(()=>{const a=h.find(r=>r.id===e.from_account_id);if(a){const r=a.account_type==="credit_card",u=parseFloat(e.amount)||0;let n=a.balance,p=0,_=!1;if(r&&a.credit_limit){const y=e.from_account_id===H,L=(s&&y?a.balance-z:a.balance)+u;n=a.credit_limit-a.balance,p=a.credit_limit-L,_=L>a.credit_limit}return t.jsxs("div",{className:"mt-2 p-3 rounded-lg bg-muted/50 border border-border",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm text-muted-foreground",children:r?"Current Balance Limit":"Current Balance"}),t.jsx("span",{className:`text-sm font-semibold ${!r&&n<0?"text-destructive":""}`,children:S(r?(a.credit_limit||0)-a.balance:n,a.currency)})]}),r&&t.jsxs("div",{className:"flex items-center justify-between mt-1 pt-1 border-t border-dashed",children:[t.jsx("span",{className:"text-sm font-medium",children:"Projected Balance Limit"}),t.jsx("span",{className:`text-sm font-bold ${_?"text-destructive":"text-emerald-600 dark:text-emerald-400"}`,children:S(p,a.currency)})]})]})}return null})()]}),(e.transaction_type==="income"||e.transaction_type==="transfer"||e.transaction_type==="withdrawal"||e.transaction_type==="loan_payment"||e.transaction_type==="credit_card_repayment")&&t.jsxs("div",{className:"space-y-2",children:[t.jsx(E,{htmlFor:"to_account_id",children:e.transaction_type==="withdrawal"?"To Cash Account *":e.transaction_type==="credit_card_repayment"?"To Credit Card *":e.transaction_type==="loan_payment"?"To Loan Account *":"To Account *"}),t.jsxs(q,{value:e.to_account_id,onValueChange:a=>l({...e,to_account_id:a}),children:[t.jsx($,{children:t.jsx(U,{placeholder:"Select account"})}),t.jsx(V,{children:e.transaction_type==="withdrawal"?h.filter(a=>a.account_type==="cash").map(a=>t.jsx(f,{value:a.id,children:a.account_name},a.id)):e.transaction_type==="credit_card_repayment"?h.filter(a=>a.account_type==="credit_card").map(a=>t.jsx(f,{value:a.id,children:a.account_name},a.id)):e.transaction_type==="loan_payment"?h.filter(a=>a.account_type==="loan").map(a=>t.jsx(f,{value:a.id,children:a.account_name},a.id)):h.map(a=>t.jsxs(f,{value:a.id,children:[a.account_name," (",a.account_type,")"]},a.id))})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(E,{htmlFor:"amount",children:"Amount *"}),t.jsx(K,{id:"amount",type:"number",step:"0.01",min:"0",value:e.amount,onChange:a=>l({...e,amount:a.target.value}),placeholder:"0.00",required:!0})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(E,{htmlFor:"transaction_date",children:"Date *"}),t.jsx(K,{id:"transaction_date",type:"date",value:e.transaction_date,onChange:a=>l({...e,transaction_date:a.target.value}),required:!0})]})]}),(e.transaction_type==="income"||e.transaction_type==="expense"||e.transaction_type==="loan_payment")&&t.jsxs("div",{className:"space-y-2",children:[t.jsx(E,{htmlFor:"category",children:e.transaction_type==="income"?"Income Category":"Expense Category"}),e.transaction_type==="income"?t.jsxs(q,{value:e.income_category,onValueChange:a=>l({...e,income_category:a}),children:[t.jsx($,{children:t.jsx(U,{placeholder:"Select income category"})}),t.jsx(V,{children:Xe.map(a=>t.jsxs(f,{value:a.key,children:[a.icon," ",a.name]},a.key))})]}):t.jsxs(q,{value:e.category,onValueChange:a=>l({...e,category:a}),children:[t.jsx($,{children:t.jsx(U,{placeholder:"Select expense category"})}),t.jsx(V,{children:g.map(a=>t.jsxs(f,{value:a.name,children:[a.icon," ",a.name]},a.id))})]}),(e.transaction_type==="expense"||e.transaction_type==="loan_payment")&&e.category&&t.jsx("div",{className:"mt-3",children:A?t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[t.jsx(ee,{className:"h-4 w-4 animate-spin"}),"Loading budget info..."]}):d?t.jsxs(X,{className:`${d.remaining<0?"border-red-500 bg-red-50 dark:bg-red-950/20":d.remaining<d.budgeted*.2?"border-amber-500 bg-amber-50 dark:bg-amber-950/20":"border-blue-500 bg-blue-50 dark:bg-blue-950/20"}`,children:[t.jsx(Qe,{className:`h-4 w-4 ${d.remaining<0?"text-red-600":d.remaining<d.budgeted*.2?"text-amber-600":"text-blue-600"}`}),t.jsx(Y,{children:t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"font-semibold text-sm",children:["Budget Status for ",e.category]}),t.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-muted-foreground",children:"Budgeted"}),t.jsx("div",{className:"font-medium",children:S(d.budgeted,e.currency)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-muted-foreground",children:"Spent"}),t.jsx("div",{className:"font-medium",children:S(d.spent,e.currency)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-muted-foreground",children:"Remaining"}),t.jsx("div",{className:`font-medium ${d.remaining<0?"text-red-600 dark:text-red-400":d.remaining<d.budgeted*.2?"text-amber-600 dark:text-amber-400":"text-emerald-600 dark:text-emerald-400"}`,children:S(d.remaining,e.currency)})]})]}),d.remaining<0&&t.jsxs("div",{className:"flex items-center gap-1 text-red-600 dark:text-red-400 text-xs mt-2",children:[t.jsx(ae,{className:"h-3 w-3"}),t.jsxs("span",{children:["Budget exceeded by ",S(Math.abs(d.remaining),e.currency)]})]}),d.remaining>=0&&d.remaining<d.budgeted*.2&&t.jsxs("div",{className:"flex items-center gap-1 text-amber-600 dark:text-amber-400 text-xs mt-2",children:[t.jsx(ae,{className:"h-3 w-3"}),t.jsxs("span",{children:["Low budget remaining (",(d.remaining/d.budgeted*100).toFixed(0),"%)"]})]})]})})]}):null})]}),R&&t.jsxs(X,{className:"border-amber-500 bg-amber-50 dark:bg-amber-950/20",children:[t.jsx(ae,{className:"h-4 w-4 text-amber-600"}),t.jsx(Y,{className:"text-amber-900 dark:text-amber-200",children:R})]}),e.from_account_id&&((ie=h.find(a=>a.id===e.from_account_id))==null?void 0:ie.account_type)==="credit_card"&&t.jsxs("div",{className:"space-y-4 border rounded-lg p-4 bg-muted/30",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(at,{id:"is_emi",checked:e.is_emi,onCheckedChange:a=>l({...e,is_emi:a,emi_months:a?e.emi_months:"",bank_charges:a?e.bank_charges:""})}),t.jsxs(E,{htmlFor:"is_emi",className:"flex items-center gap-2 cursor-pointer",children:[t.jsx(ne,{className:"h-4 w-4"}),"Convert to EMI (Equated Monthly Installment)"]})]}),e.is_emi&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(E,{htmlFor:"emi_months",children:"EMI Duration (Months) *"}),t.jsx(K,{id:"emi_months",type:"number",min:"1",max:"60",value:e.emi_months,onChange:a=>l({...e,emi_months:a.target.value}),placeholder:"e.g., 12",required:e.is_emi}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Number of monthly installments (1-60)"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(E,{htmlFor:"bank_charges",children:"Bank Charges *"}),t.jsx(K,{id:"bank_charges",type:"number",min:"0",step:"0.01",value:e.bank_charges,onChange:a=>l({...e,bank_charges:a.target.value}),placeholder:"0.00",required:e.is_emi}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Processing fees and interest charges"})]})]}),w&&t.jsxs(X,{className:"border-blue-500 bg-blue-50 dark:bg-blue-950/20",children:[t.jsx(ne,{className:"h-4 w-4 text-blue-600"}),t.jsx(Y,{children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"font-semibold text-sm text-blue-900 dark:text-blue-200",children:"EMI Calculation Summary"}),t.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-muted-foreground",children:"Monthly EMI"}),t.jsx("div",{className:"font-bold text-lg text-blue-600 dark:text-blue-400",children:S(w.monthlyEMI,e.currency)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-muted-foreground",children:"Total Amount"}),t.jsx("div",{className:"font-medium",children:S(w.totalAmount,e.currency)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-muted-foreground",children:"Total Interest"}),t.jsx("div",{className:"font-medium",children:S(w.totalInterest,e.currency)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-muted-foreground",children:"Effective Rate"}),t.jsxs("div",{className:"font-medium",children:[w.effectiveRate.toFixed(2),"%"]})]})]})]})})]})]})]}),e.from_account_id&&!e.is_emi&&((ce=h.find(a=>a.id===e.from_account_id))==null?void 0:ce.account_type)==="credit_card"&&F&&t.jsxs(X,{className:"border-purple-500 bg-purple-50 dark:bg-purple-950/20",children:[t.jsx(ne,{className:"h-4 w-4 text-purple-600"}),t.jsx(Y,{children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"font-semibold text-sm text-purple-900 dark:text-purple-200",children:"Credit Card Billing Information"}),t.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-muted-foreground",children:"Statement Date"}),t.jsx("div",{className:"font-medium text-purple-600 dark:text-purple-400",children:F.statementDate.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-muted-foreground",children:"Payment Due Date"}),t.jsx("div",{className:"font-medium text-purple-600 dark:text-purple-400",children:F.dueDate.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]})]}),t.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["This transaction will be included in the statement generated on ",F.statementDate.toLocaleDateString("en-US",{month:"short",day:"numeric"})," and payment will be due on ",F.dueDate.toLocaleDateString("en-US",{month:"short",day:"numeric"}),"."]})]})})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(E,{htmlFor:"description",children:"Description"}),t.jsx(Ue,{id:"description",value:e.description,onChange:a=>l({...e,description:a.target.value}),placeholder:"Add a note about this transaction",rows:3})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs(te,{type:"submit",disabled:m,className:"flex-1",children:[m&&t.jsx(ee,{className:"mr-2 h-4 w-4 animate-spin"}),s?"Update Transaction":"Create Transaction"]}),t.jsx(te,{type:"button",variant:"outline",onClick:()=>x("/transactions"),children:"Cancel"})]})]})})]})]})}export{xt as default};
