import{c as ue,u as ce,r as l,i as G,j as e,D as fe,H as je,B as o,m as pe,n as ge,o as Ne,C as _,h as b,L as Y,I as Z,x as ye,z as ve,J as _e,d as ee,k as be,t as se,S as te,K as ae,W as H,e as P,f as R,M as we}from"./index-CadMXyJB.js";import{B as A}from"./badge-i6nMjZC_.js";import{P as re}from"./progress-B0zBlC70.js";import{f as n,b as ie}from"./format-RllGV7dv.js";import{T as ne}from"./trending-up-BBYh76Q9.js";import{P as Q}from"./plus-nRr9gPfm.js";import{C as Ae,a as Ce,B as V}from"./BankLogo-j26DLqyT.js";import{f as le}from"./format-B3XKS-z2.js";import{c as De,a as ke}from"./loanCalculations-CzUqBpRv.js";import{c as Se,s as Ee,g as Ie,a as Me,b as Le,d as Te,e as Be}from"./statementCalculations-BIN_tZQj.js";import{g as de}from"./billingCycleCalculations-BxPZ0iWz.js";import{c as He}from"./cache-SNmVlzwA.js";import{A as Pe,a as Re,b as ze,c as Fe,d as $e,e as Oe,f as qe,g as Ue}from"./alert-dialog-D5-RVg6R.js";import{S as z}from"./square-pen-YCFt9pMo.js";import{T as F}from"./trash-2-Co2tl0ej.js";import{C as We}from"./credit-card-CLQXqH6e.js";import{C as Je,a as Ke}from"./chevron-up-DrbdFayN.js";import"./countries-BGn44Cmt.js";/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Ge=ue("history",Ve);function Qe({accountId:h,accountName:C,currentRate:N,onRateUpdated:D}){const{toast:y}=ce(),[u,$]=l.useState(!1),[O,k]=l.useState(!1),[E,j]=l.useState([]),[v,p]=l.useState(!1),[x,S]=l.useState({interest_rate:"",effective_date:new Date().toISOString().split("T")[0]});l.useEffect(()=>{u&&I()},[u]);const I=async()=>{p(!0);try{const r=await G.getInterestRateHistory(h);j(r)}catch(r){console.error("Error loading interest rate history:",r)}finally{p(!1)}},q=async r=>{if(r.preventDefault(),!x.interest_rate||!x.effective_date){y({title:"Error",description:"Please fill in all fields",variant:"destructive"});return}k(!0);try{await G.addInterestRate({account_id:h,interest_rate:parseFloat(x.interest_rate),effective_date:x.effective_date}),y({title:"Success",description:"Interest rate updated successfully"}),S({interest_rate:"",effective_date:new Date().toISOString().split("T")[0]}),I(),D==null||D()}catch(U){console.error("Error updating interest rate:",U),y({title:"Error",description:"Failed to update interest rate",variant:"destructive"})}finally{k(!1)}};return e.jsxs(fe,{open:u,onOpenChange:$,children:[e.jsx(je,{asChild:!0,children:e.jsxs(o,{variant:"outline",size:"sm",children:[e.jsx(ne,{className:"mr-2 h-4 w-4"}),"Update Interest Rate"]})}),e.jsxs(pe,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(ge,{children:e.jsxs(Ne,{children:["Manage Interest Rate - ",C]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(_,{children:e.jsx(b,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Current Interest Rate"}),e.jsxs("p",{className:"text-2xl font-bold",children:[typeof N=="number"?N.toFixed(2):"0.00","%"]})]}),e.jsx(ne,{className:"h-8 w-8 text-primary"})]})})}),e.jsxs("form",{onSubmit:q,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{htmlFor:"interest_rate",children:"New Interest Rate (%) *"}),e.jsx(Z,{id:"interest_rate",type:"number",step:"0.01",value:x.interest_rate,onChange:r=>S({...x,interest_rate:r.target.value}),placeholder:"5.00",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{htmlFor:"effective_date",children:"Effective Date *"}),e.jsx(Z,{id:"effective_date",type:"date",value:x.effective_date,onChange:r=>S({...x,effective_date:r.target.value}),required:!0})]}),e.jsxs(o,{type:"submit",disabled:O,className:"w-full",children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),"Add Interest Rate Change"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),"Interest Rate History"]}),v?e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading history..."}):E.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No interest rate changes recorded yet."}):e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:E.map(r=>e.jsx(_,{children:e.jsx(b,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[r.interest_rate.toFixed(2),"%"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Effective: ",le(new Date(r.effective_date),"MMM dd, yyyy")]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Added: ",le(new Date(r.created_at),"MMM dd, yyyy")]})})]})})},r.id))})]})]})]})]})}function fs(){const{user:h,profile:C}=ye(),N=ve(),D=_e(),{toast:y}=ce(),[u,$]=l.useState([]),[O,k]=l.useState(!0),[E,j]=l.useState(!1),[v,p]=l.useState(null),[x,S]=l.useState({}),[I,q]=l.useState({}),[r,U]=l.useState({}),[X,oe]=l.useState({});C!=null&&C.default_currency,l.useEffect(()=>{h&&W()},[h,D.key]);const W=async()=>{if(h){k(!0);try{const s=await ee.getAccounts(h.id);$(s);const a={};for(const t of s)if(t.account_type==="loan"&&t.loan_principal&&t.current_interest_rate&&t.loan_tenure_months){const i=De(Number(t.loan_principal),Number(t.current_interest_rate),Number(t.loan_tenure_months));let m=0;if(t.loan_start_date)try{const d=await G.getInterestRateHistory(t.id);m=ke(t.loan_start_date,Number(t.balance),d,Number(t.current_interest_rate))}catch(d){console.error("Error calculating accrued interest:",d)}a[t.id]={emi:i,accruedInterest:m}}S(a);const w={},f={};for(const t of s)if(t.account_type==="credit_card")try{const i=await be.getActiveEMIsByAccount(t.id);i.length>0&&(w[t.id]=i);const m=await se.getTransactionsByAccount(h.id,t.id);f[t.id]=m}catch(i){console.error(`Error loading data for account ${t.id}:`,i)}else if(t.account_type==="loan")try{const m=(await se.getTransactionsByAccount(h.id,t.id)).filter(d=>d.to_account_id===t.id&&d.transaction_type==="loan_payment");m.length>0&&(f[t.id]=m)}catch(i){console.error(`Error loading loan payments for account ${t.id}:`,i)}q(w),U(f)}catch(s){console.error("Error loading accounts:",s),y({title:"Error",description:"Failed to load accounts",variant:"destructive"})}finally{k(!1)}}},me=async()=>{if(v)try{await ee.deleteAccount(v.id),He.clearPattern("dashboard-"),y({title:"Success",description:"Account deleted successfully"}),W()}catch(s){console.error("Error deleting account:",s),y({title:"Error",description:"Failed to delete account",variant:"destructive"})}finally{j(!1),p(null)}},M=s=>{switch(s){case"cash":return"Cash";case"bank":return"Bank Account";case"credit_card":return"Credit Card";case"loan":return"Loan Account";default:return s}},L=s=>{switch(s){case"cash":return"default";case"bank":return"default";case"credit_card":return"secondary";case"loan":return"outline";default:return"default"}},J=s=>s.account_type==="credit_card"||s.account_type==="loan"?Number(s.balance)>0?"text-danger":"text-success":Number(s.balance)>=0?"text-success":"text-danger",g={cash:u.filter(s=>s.account_type==="cash"),bank:u.filter(s=>s.account_type==="bank"),credit_card:u.filter(s=>s.account_type==="credit_card"),loan:u.filter(s=>s.account_type==="loan")};return O?e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsx(te,{className:"h-12 w-64 bg-muted"}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(s=>e.jsx(te,{className:"h-48 bg-muted"},s))})]}):e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Accounts"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your financial accounts"})]}),e.jsx(ae,{to:"/accounts/new",children:e.jsxs(o,{children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),"Add Account"]})})]}),u.length===0?e.jsx(_,{children:e.jsxs(b,{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(H,{className:"h-16 w-16 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No accounts yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Add your first account to get started"}),e.jsx(ae,{to:"/accounts/new",children:e.jsxs(o,{children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),"Add Account"]})})]})}):e.jsxs(e.Fragment,{children:[g.cash.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-2xl font-semibold flex items-center gap-2",children:[e.jsx(H,{className:"h-6 w-6"}),"Cash Accounts"]}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:g.cash.map(s=>e.jsxs(_,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(P,{className:"flex flex-row items-start justify-between space-y-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded bg-primary/10 flex items-center justify-center",children:e.jsx(H,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx(R,{className:"text-lg break-words line-clamp-2",children:s.account_name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Physical Cash"})]})]}),e.jsx(A,{variant:L(s.account_type),children:M(s.account_type)})]}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Balance"}),e.jsx("p",{className:`text-2xl font-bold ${J(s)}`,children:n(Number(s.balance),s.currency)})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(o,{variant:"outline",size:"sm",onClick:()=>N(`/accounts/edit/${s.id}`),className:"flex-1",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsxs(o,{variant:"outline",size:"sm",onClick:()=>{p(s),j(!0)},className:"flex-1",children:[e.jsx(F,{className:"h-4 w-4 mr-2 text-danger"}),"Delete"]})]})]})]},s.id))})]}),g.bank.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-2xl font-semibold flex items-center gap-2",children:[e.jsx(Ce,{className:"h-6 w-6"}),"Bank Accounts"]}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:g.bank.map(s=>e.jsxs(_,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(P,{className:"flex flex-row items-start justify-between space-y-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(V,{src:s.institution_logo,alt:s.institution_name||"Bank",className:"h-10 w-10"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(R,{className:"text-lg break-words line-clamp-2",children:s.account_name}),e.jsx("p",{className:"text-sm text-muted-foreground break-words line-clamp-1",children:s.institution_name})]})]}),e.jsx(A,{variant:L(s.account_type),children:M(s.account_type)})]}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Account Number"}),e.jsx("p",{className:"font-medium",children:ie(s.last_4_digits)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Balance"}),e.jsx("p",{className:`text-2xl font-bold ${J(s)}`,children:n(Number(s.balance),s.currency)})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(o,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>N(`/accounts/edit/${s.id}`),children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>{p(s),j(!0)},children:e.jsx(F,{className:"h-4 w-4 text-danger"})})]})]})]},s.id))})]}),g.credit_card.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-2xl font-semibold flex items-center gap-2",children:[e.jsx(We,{className:"h-6 w-6"}),"Credit Cards"]}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:g.credit_card.map(s=>{const a=I[s.id]||[],w=r[s.id]||[];let f=s.balance,t=0,i=!1,m=null,d=null;s.statement_day?(f=Se(s.id,s.statement_day,w,a).statementAmount,i=Ee(s.statement_day),i&&(t=Math.abs(f),s.due_day&&(m=Ie(s.statement_day,s.due_day),d=de(s.statement_day,s.due_day)))):(f=Me(s.balance,a),t=Math.abs(f),i=!0,s.statement_day&&s.due_day&&(d=de(s.statement_day,s.due_day)));const xe=a.reduce((c,K)=>c+K.monthly_emi,0),T=s.credit_limit?Le(s.balance,s.credit_limit):null,B=s.credit_limit?Te(s.balance,s.credit_limit):"safe",he=s.credit_limit?Be(s.balance,s.credit_limit):null;return e.jsxs(_,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(P,{className:"flex flex-row items-start justify-between space-y-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(V,{src:s.institution_logo,alt:s.institution_name||"Credit Card",className:"h-10 w-10"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(R,{className:"text-lg break-words line-clamp-2",children:s.account_name}),e.jsx("p",{className:"text-sm text-muted-foreground break-words line-clamp-1",children:s.institution_name})]})]}),e.jsx(A,{variant:L(s.account_type),children:M(s.account_type)})]}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Card Number"}),e.jsx("p",{className:"font-medium",children:ie(s.last_4_digits)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Outstanding Balance"}),e.jsx("p",{className:`text-2xl font-bold ${J(s)}`,children:n(Number(s.balance),s.currency)}),a.length>0&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["+ ",n(xe,s.currency)," in monthly installments"]})]}),s.credit_limit&&e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Credit Utilization"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`text-sm font-semibold ${B==="danger"?"text-red-600 dark:text-red-400":B==="warning"?"text-amber-600 dark:text-amber-400":"text-emerald-600 dark:text-emerald-400"}`,children:[T==null?void 0:T.toFixed(1),"%"]}),B!=="safe"&&e.jsx(we,{className:`h-4 w-4 ${B==="danger"?"text-red-600":"text-amber-600"}`})]})]}),e.jsx(re,{value:T||0,className:"h-2"}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Available: ",n(he||0,s.currency)]}),e.jsxs("span",{children:["Limit: ",n(s.credit_limit,s.currency)]})]})]}),a.length>0&&e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active EMIs"}),e.jsx(A,{variant:"secondary",children:a.length})]}),e.jsx("div",{className:"space-y-2",children:a.map(c=>{const K=c.monthly_emi*c.remaining_installments;return e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium truncate max-w-[180px]",children:c.description}),e.jsxs(A,{variant:"outline",className:"text-xs",children:[c.remaining_installments,"/",c.emi_months]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Monthly EMI"}),e.jsx("span",{className:"font-semibold",children:n(c.monthly_emi,s.currency)})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Remaining"}),e.jsx("span",{className:"font-semibold",children:n(K,s.currency)})]}),e.jsx(re,{value:(c.emi_months-c.remaining_installments)/c.emi_months*100,className:"h-1 mt-2"})]},c.id)})}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Total Statement Amount"}),e.jsx("p",{className:"text-lg font-bold text-purple-600 dark:text-purple-400",children:n(f,s.currency)})]})]}),i&&(d||m)&&e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Payment Due"}),e.jsx("p",{className:"text-lg font-bold text-purple-600 dark:text-purple-400",children:t>0?n(t,s.currency):n(0,s.currency)})]}),e.jsxs("div",{className:"text-xs text-muted-foreground text-right",children:["Due on ",m?m.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):d==null?void 0:d.dueDateStr]})]}),!i&&s.statement_day&&e.jsx("div",{className:"space-y-2 pt-2 border-t",children:e.jsxs("div",{className:"text-sm text-muted-foreground text-center",children:["Statement will be generated on day ",s.statement_day]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(o,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>N(`/accounts/edit/${s.id}`),children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>{p(s),j(!0)},children:e.jsx(F,{className:"h-4 w-4 text-danger"})})]})]})]},s.id)})})]}),g.loan.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-2xl font-semibold flex items-center gap-2",children:[e.jsx(H,{className:"h-6 w-6"}),"Loan Accounts"]}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:g.loan.map(s=>e.jsxs(_,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(P,{className:"flex flex-row items-start justify-between space-y-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(V,{src:s.institution_logo,alt:s.institution_name||"Loan",className:"h-10 w-10"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(R,{className:"text-lg break-words line-clamp-2",children:s.account_name}),e.jsx("p",{className:"text-sm text-muted-foreground break-words line-clamp-1",children:s.institution_name})]})]}),e.jsx(A,{variant:L(s.account_type),children:M(s.account_type)})]}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Principal"}),e.jsx("p",{className:"font-medium",children:n(Number(s.loan_principal||0),s.currency)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Tenure"}),e.jsxs("p",{className:"font-medium",children:[s.loan_tenure_months," months"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Interest Rate (",s.interest_rate_type,")"]}),e.jsxs("p",{className:"font-medium",children:[s.current_interest_rate,"% APR"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Payment Due Date"}),e.jsx("p",{className:"font-medium",children:s.due_date?`${s.due_date} of each month`:"Not set"})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:x[s.id]&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Monthly EMI"}),e.jsx("p",{className:"font-medium text-primary",children:n(x[s.id].emi,s.currency)})]})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Outstanding Balance"}),e.jsx("p",{className:"text-xl font-bold text-danger",children:n(Number(s.balance),s.currency)})]}),s.interest_rate_type==="floating"&&e.jsx(Qe,{accountId:s.id,accountName:s.account_name,currentRate:s.current_interest_rate||0,onRateUpdated:W}),r[s.id]&&r[s.id].length>0&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs(o,{variant:"ghost",size:"sm",className:"w-full justify-between",onClick:()=>oe(a=>({...a,[s.id]:!a[s.id]})),children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"h-4 w-4"}),"Payment History (",r[s.id].length,")"]}),X[s.id]?e.jsx(Je,{className:"h-4 w-4"}):e.jsx(Ke,{className:"h-4 w-4"})]}),X[s.id]&&e.jsx("div",{className:"mt-3 space-y-2 max-h-60 overflow-y-auto",children:r[s.id].sort((a,w)=>new Date(w.transaction_date).getTime()-new Date(a.transaction_date).getTime()).map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50 hover:bg-muted transition-colors",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium",children:new Date(a.transaction_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}),a.description&&e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:a.description})]}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-sm font-semibold text-emerald-600 dark:text-emerald-400",children:n(a.amount,a.currency)})})]},a.id))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(o,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>N(`/accounts/edit/${s.id}`),children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>{p(s),j(!0)},children:e.jsx(F,{className:"h-4 w-4 text-danger"})})]})]})]},s.id))})]})]}),e.jsx(Pe,{open:E,onOpenChange:j,children:e.jsxs(Re,{children:[e.jsxs(ze,{children:[e.jsx(Fe,{children:"Delete Account"}),e.jsxs($e,{children:['Are you sure you want to delete "',v==null?void 0:v.account_name,'"? This action cannot be undone. All associated transactions will also be affected.']})]}),e.jsxs(Oe,{children:[e.jsx(qe,{children:"Cancel"}),e.jsx(Ue,{onClick:me,className:"bg-danger text-danger-foreground hover:bg-danger/90",children:"Delete"})]})]})})]})}export{fs as default};
