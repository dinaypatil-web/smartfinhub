function M(r,i,o){if(r<=0||i<=0||o<=0)return 0;const s=i/12/100,n=r*s*Math.pow(1+s,o)/(Math.pow(1+s,o)-1);return Math.round(n*100)/100}function T(r,i,o,s){if(!r||i<=0)return 0;const n=new Date(r),c=new Date;if(n>c)return 0;const l=[...o].sort((t,e)=>new Date(t.effective_date).getTime()-new Date(e.effective_date).getTime());let f=0,a=n;for(let t=0;t<l.length;t++){const e=l[t],m=new Date(e.effective_date);if(!(m<n)){if(t===0&&m>n){const u=Math.floor((m.getTime()-a.getTime())/864e5),d=i*s*u/(365*100);f+=d}a=m}}if(l.length>0){const t=l[l.length-1],e=new Date(t.effective_date);if(e<=c){const m=Math.floor((c.getTime()-e.getTime())/864e5),u=i*t.interest_rate*m/(365*100);f+=u}}else{const t=Math.floor((c.getTime()-n.getTime())/864e5),e=i*s*t/(365*100);f+=e}return Math.round(f*100)/100}function v(r,i="INR"){return new Intl.NumberFormat("en-US",{style:"currency",currency:i,minimumFractionDigits:2,maximumFractionDigits:2}).format(r)}function g(r,i,o,s){const n=[...s].sort((a,t)=>new Date(a.effective_date).getTime()-new Date(t.effective_date).getTime());let c=0,l=r;for(let a=0;a<n.length;a++){const t=n[a],e=new Date(t.effective_date);if(e<=l)continue;if(e>=i)break;const m=e,u=Math.floor((m.getTime()-l.getTime())/(1e3*60*60*24)),d=a>0?n[a-1].interest_rate:n[0].interest_rate,p=o*d*u/(365*100);c+=p,l=m}const f=Math.floor((i.getTime()-l.getTime())/(1e3*60*60*24));if(f>0){const a=n.length>0?n[n.length-1].interest_rate:0,t=o*a*f/(365*100);c+=t}return c}function _(r,i){const o=new Date(r);return o.setDate(i),o<=r&&o.setMonth(o.getMonth()+1),o}function y(r,i,o,s,n,c,l){if(s<=0||n<=0)return{principalComponent:0,interestComponent:0,newOutstandingPrincipal:0};const f=new Date(i||r),a=new Date(o);let t=0,e=0;if(l){const d=_(f,l);if(a<d){const p=g(f,a,s,c),D=n-p,h=s-D,w=g(a,d,h,c);t=p+w,e=n-t}else t=g(f,a,s,c),e=n-t}else t=g(f,a,s,c),e=n-t;const m=Math.round(t*100)/100;e=Math.round(e*100)/100;const u=Math.max(0,Math.round((s-e)*100)/100);return{principalComponent:e,interestComponent:m,newOutstandingPrincipal:u}}function I(r,i,o,s,n){const c=[];let l=i,f=null;for(let a=0;a<o.length;a++){const t=o[a],e=y(r,f,t.payment_date,l,t.emi_amount,s,n);c.push({payment_date:t.payment_date,emi_amount:t.emi_amount,principal_component:e.principalComponent,interest_component:e.interestComponent,outstanding_principal:e.newOutstandingPrincipal,payment_number:a+1}),l=e.newOutstandingPrincipal,f=t.payment_date}return c}export{T as a,I as b,M as c,v as f};
