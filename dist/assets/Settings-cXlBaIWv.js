import{c as v,u as R,r as i,j as e,D as H,H as Q,B as w,m as V,n as O,o as B,v as K,L as n,I as b,a1 as W,A as M,a4 as I,x as X,a5 as Z,C as P,e as S,f as _,y as E,h as D,a6 as ee,a7 as $,a8 as se,a9 as U}from"./index-CadMXyJB.js";import{S as L,a as T,b as A,c as z,d as q}from"./select-BtuBbjBO.js";import{c as F}from"./countries-BGn44Cmt.js";import"./chevron-up-DrbdFayN.js";/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]],ae=v("key-round",re);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],ne=v("monitor",te);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],oe=v("moon",ie);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],de=v("palette",ce);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],ue=v("sun",le);function he({trigger:m}){const{toast:s}=R(),[C,t]=i.useState(!1),[x,o]=i.useState(!1),[p,y]=i.useState(""),[c,u]=i.useState(""),[k,l]=i.useState(""),N=async a=>{if(a.preventDefault(),c!==k){s({title:"Error",description:"New passwords do not match",variant:"destructive"});return}if(c.length<6){s({title:"Error",description:"Password must be at least 6 characters",variant:"destructive"});return}if(c===p){s({title:"Error",description:"New password must be different from current password",variant:"destructive"});return}o(!0);try{const{data:{user:d}}=await I.auth.getUser();if(!(d!=null&&d.email))throw new Error("User email not found");const{error:h}=await I.auth.signInWithPassword({email:d.email,password:p});if(h)throw new Error("Current password is incorrect");const{error:f}=await I.auth.updateUser({password:c});if(f)throw f;s({title:"Success",description:"Your password has been changed successfully"}),t(!1),y(""),u(""),l("")}catch(d){s({title:"Error",description:d.message||"Failed to change password",variant:"destructive"})}finally{o(!1)}},g=a=>{t(a),a||(y(""),u(""),l(""))};return e.jsxs(H,{open:C,onOpenChange:g,children:[e.jsx(Q,{asChild:!0,children:m||e.jsxs(w,{variant:"outline",className:"w-full justify-start",children:[e.jsx(ae,{className:"mr-2 h-4 w-4"}),"Change Password"]})}),e.jsxs(V,{className:"sm:max-w-md",children:[e.jsxs(O,{children:[e.jsx(B,{children:"Change Password"}),e.jsx(K,{children:"Enter your current password and choose a new password."})]}),e.jsxs("form",{onSubmit:N,children:[e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"current-password",children:"Current Password"}),e.jsx(b,{id:"current-password",type:"password",placeholder:"••••••••",value:p,onChange:a=>y(a.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"new-password",children:"New Password"}),e.jsx(b,{id:"new-password",type:"password",placeholder:"••••••••",value:c,onChange:a=>u(a.target.value),required:!0,minLength:6}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Must be at least 6 characters"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"confirm-new-password",children:"Confirm New Password"}),e.jsx(b,{id:"confirm-new-password",type:"password",placeholder:"••••••••",value:k,onChange:a=>l(a.target.value),required:!0,minLength:6})]})]}),e.jsx(W,{children:e.jsxs(w,{type:"submit",disabled:x,className:"w-full shadow-elegant hover:shadow-glow transition-smooth",children:[x&&e.jsx(M,{className:"mr-2 h-4 w-4 animate-spin"}),"Change Password"]})})]})]})]})}function ge(){const{user:m,profile:s,refreshProfile:C}=X(),{theme:t,setTheme:x}=Z(),{toast:o}=R(),[p,y]=i.useState(!1),[c,u]=i.useState({default_country:(s==null?void 0:s.default_country)||"IN",default_currency:(s==null?void 0:s.default_currency)||"INR"}),[k,l]=i.useState(!1),[N,g]=i.useState(""),[a,d]=i.useState(""),[h,f]=i.useState(!1);i.useEffect(()=>{s&&u({default_country:s.default_country,default_currency:s.default_currency})},[s]);const Y=async r=>{if(r.preventDefault(),!!m){y(!0);try{await U.updateProfile(m.id,c),await C(),o({title:"Success",description:"Settings updated successfully"})}catch(j){console.error("Error updating settings:",j),o({title:"Error",description:j.message||"Failed to update settings",variant:"destructive"})}finally{y(!1)}}},G=async()=>{if(!m||!(s!=null&&s.email)){o({title:"Error",description:"User information not available",variant:"destructive"});return}if(!N.trim()){o({title:"Error",description:"Please enter a phone number",variant:"destructive"});return}if(!a.trim()){o({title:"Error",description:"Please enter your password to confirm",variant:"destructive"});return}f(!0);try{const{error:r}=await I.auth.signInWithPassword({email:s.email,password:a});if(r){o({title:"Error",description:"Incorrect password. Please try again.",variant:"destructive"}),f(!1);return}await U.updateProfile(m.id,{phone:N}),await C(),o({title:"Success",description:"Phone number updated successfully. A notification has been sent to your email."}),l(!1),g(""),d("")}catch(r){console.error("Error updating phone:",r),o({title:"Error",description:r.message||"Failed to update phone number",variant:"destructive"})}finally{f(!1)}};return e.jsxs("div",{className:"container mx-auto p-6 max-w-2xl space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"animate-slide-down",children:[e.jsx("h1",{className:"text-3xl font-bold gradient-text",children:"Settings"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your account preferences"})]}),e.jsxs(P,{className:"animate-slide-up",children:[e.jsxs(S,{children:[e.jsxs(_,{className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-5 w-5"}),"Appearance"]}),e.jsx(E,{children:"Customize the look and feel of the application"})]}),e.jsx(D,{children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Theme"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Choose your preferred theme or sync with your system settings"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("button",{onClick:()=>x("light"),className:`flex flex-col items-center gap-2 p-4 rounded-lg border-2 transition-all hover:shadow-md ${t==="light"?"border-primary bg-primary/5 shadow-md":"border-border hover:border-primary/50"}`,children:[e.jsx(ue,{className:`h-6 w-6 ${t==="light"?"text-primary":"text-muted-foreground"}`}),e.jsx("span",{className:`text-sm font-medium ${t==="light"?"text-primary":"text-foreground"}`,children:"Light"})]}),e.jsxs("button",{onClick:()=>x("dark"),className:`flex flex-col items-center gap-2 p-4 rounded-lg border-2 transition-all hover:shadow-md ${t==="dark"?"border-primary bg-primary/5 shadow-md":"border-border hover:border-primary/50"}`,children:[e.jsx(oe,{className:`h-6 w-6 ${t==="dark"?"text-primary":"text-muted-foreground"}`}),e.jsx("span",{className:`text-sm font-medium ${t==="dark"?"text-primary":"text-foreground"}`,children:"Dark"})]}),e.jsxs("button",{onClick:()=>x("system"),className:`flex flex-col items-center gap-2 p-4 rounded-lg border-2 transition-all hover:shadow-md ${t==="system"?"border-primary bg-primary/5 shadow-md":"border-border hover:border-primary/50"}`,children:[e.jsx(ne,{className:`h-6 w-6 ${t==="system"?"text-primary":"text-muted-foreground"}`}),e.jsx("span",{className:`text-sm font-medium ${t==="system"?"text-primary":"text-foreground"}`,children:"System"})]})]}),t==="system"&&e.jsx("div",{className:"mt-3 p-3 bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:e.jsxs("p",{className:"text-xs text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:"System mode:"})," The theme will automatically switch based on your device's system preferences."]})})]})})})]}),e.jsxs(P,{className:"animate-slide-up animate-stagger-1",children:[e.jsxs(S,{children:[e.jsx(_,{children:"Regional Settings"}),e.jsx(E,{children:"Set your default country and currency for the dashboard display"})]}),e.jsx(D,{children:e.jsxs("form",{onSubmit:Y,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"default_country",children:"Default Country"}),e.jsxs(L,{value:c.default_country,onValueChange:r=>{const j=F.find(J=>J.code===r);u({default_country:r,default_currency:(j==null?void 0:j.currency)||c.default_currency})},children:[e.jsx(T,{children:e.jsx(A,{})}),e.jsx(z,{children:F.map(r=>e.jsx(q,{value:r.code,children:r.name},r.code))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"default_currency",children:"Default Currency"}),e.jsxs(L,{value:c.default_currency,onValueChange:r=>u({...c,default_currency:r}),children:[e.jsx(T,{children:e.jsx(A,{})}),e.jsx(z,{children:F.map(r=>e.jsxs(q,{value:r.currency,children:[r.currency," - ",r.name]},r.currency))})]})]}),e.jsxs(w,{type:"submit",disabled:p,children:[p&&e.jsx(M,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Settings"]})]})})]}),e.jsxs(P,{className:"animate-slide-up animate-stagger-2",children:[e.jsxs(S,{children:[e.jsx(_,{children:"Account Information"}),e.jsx(E,{children:"Your account details"})]}),e.jsxs(D,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs(n,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"Email"]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:(s==null?void 0:s.email)||"Not set"})]}),e.jsxs("div",{children:[e.jsxs(n,{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4"}),"Phone Number"]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground flex-1",children:(s==null?void 0:s.phone)||"Not set"}),e.jsx(w,{variant:"outline",size:"sm",onClick:()=>{g((s==null?void 0:s.phone)||""),l(!0)},children:"Update"})]})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Role"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1 capitalize",children:(s==null?void 0:s.role)||"user"})]})]})]}),e.jsxs(P,{className:"animate-slide-up animate-stagger-3",children:[e.jsxs(S,{children:[e.jsx(_,{children:"Security"}),e.jsx(E,{children:"Manage your account security settings"})]}),e.jsx(D,{children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(n,{children:"Password"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1 mb-3",children:"Keep your account secure by using a strong password"}),e.jsx(he,{})]})})})]}),e.jsx(H,{open:k,onOpenChange:l,children:e.jsxs(V,{children:[e.jsxs(O,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-5 w-5"}),"Update Phone Number"]}),e.jsx(K,{children:"Enter your new phone number and confirm with your password for security."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"newPhone",children:"New Phone Number"}),e.jsx(b,{id:"newPhone",type:"tel",placeholder:"+1 234 567 8900",value:N,onChange:r=>g(r.target.value),disabled:h}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Include country code (e.g., +1 for US, +91 for India)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{htmlFor:"password",className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4"}),"Confirm Password"]}),e.jsx(b,{id:"password",type:"password",placeholder:"Enter your password",value:a,onChange:r=>d(r.target.value),disabled:h}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"For security, please confirm your password to update your phone number."})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:e.jsxs("p",{className:"text-xs text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:"Note:"})," After updating, a confirmation email will be sent to your registered email address."]})})]}),e.jsxs(W,{children:[e.jsx(w,{variant:"outline",onClick:()=>{l(!1),g(""),d("")},disabled:h,children:"Cancel"}),e.jsxs(w,{onClick:G,disabled:h,children:[h&&e.jsx(M,{className:"mr-2 h-4 w-4 animate-spin"}),"Update Phone Number"]})]})]})})]})}export{ge as default};
