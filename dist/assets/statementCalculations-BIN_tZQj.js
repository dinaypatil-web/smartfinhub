function Y(e,t,n){return n<=0?0:(e+t)/n}function v(e,t){return e+t}function $(e,t){const n=t.reduce((a,i)=>{const r=Math.max(0,i.remaining_installments-1);return a+i.monthly_emi*r},0);return Math.max(0,e-n)}function p(e,t){return t?Math.max(0,t-e):0}function h(e,t){return!t||t===0?0:e/t*100}function b(e,t){if(!t)return"safe";const n=h(e,t);return n>=100?"danger":n>=80?"warning":"safe"}function E(e,t,n){const a=b(e,t),i=h(e,t);if(a==="danger")return`⚠️ Credit limit exceeded! You are at ${i.toFixed(1)}% utilization.`;if(a==="warning"){const r=p(e,t);return`⚠️ Approaching credit limit! ${i.toFixed(1)}% used. ${n} ${r.toFixed(2)} available.`}return null}function T(e,t,n){if(!n)return{valid:!0};const a=e+t;return a>n?{valid:!1,message:`Transaction exceeds credit limit by ${(a-n).toFixed(2)}. Current balance: ${e.toFixed(2)}, Credit limit: ${n.toFixed(2)}`}:{valid:!0}}function I(e,t,n){const a=v(e,t),i=Y(e,t,n),r=t,u=n>0?t/e*100:0;return{monthlyEMI:i,totalAmount:a,totalInterest:r,effectiveRate:u}}function m(e,t=new Date){const n=t.getFullYear(),a=t.getMonth(),i=t.getDate(),r=new Date(n,a,e),u=new Date(n,a-1,e),s=i>=e;return{lastStatementDate:u,currentStatementDate:r,isAfterStatementDate:s}}function z(e,t,n,a,i=new Date){const{lastStatementDate:r,currentStatementDate:u,isAfterStatementDate:s}=m(t,i);let f,c;s?(f=r,c=u):(f=new Date(r.getFullYear(),r.getMonth()-1,t),c=r);const D=n.filter(o=>{const l=new Date(o.transaction_date);return(o.from_account_id===e||o.to_account_id===e)&&l>=f&&l<c}),_=new Set(a.filter(o=>o.transaction_id).map(o=>o.transaction_id)),d=D.filter(o=>!_.has(o.id)).reduce((o,l)=>l.from_account_id===e?o+Math.abs(Number(l.amount)):l.to_account_id===e&&(l.transaction_type==="transfer"||l.transaction_type==="credit_card_repayment")?o-Math.abs(Number(l.amount)):o,0),w=c.getMonth()+1,S=c.getFullYear(),g=a.filter(o=>{if(!o.start_date)return!1;const l=new Date(o.start_date),x=l.getMonth()+1,F=l.getFullYear(),M=(S-F)*12+(w-x);return M>=0&&M<o.emi_months&&o.remaining_installments>0}).reduce((o,l)=>o+Number(l.monthly_emi),0),A=d+g;return{statementAmount:Math.round(A*100)/100,transactionsAmount:Math.round(d*100)/100,emisAmount:Math.round(g*100)/100,dueDate:null}}function N(e,t,n=new Date){if(!e||!t)return null;const{currentStatementDate:a,isAfterStatementDate:i}=m(e,n);let r;i?r=a:r=new Date(a.getFullYear(),a.getMonth()-1,e);let u;return t>=e?u=new Date(r.getFullYear(),r.getMonth(),t):u=new Date(r.getFullYear(),r.getMonth()+1,t),u}function P(e,t=new Date){const{isAfterStatementDate:n}=m(e,t);return n}function W(e,t,n){const a=n.getFullYear(),i=n.getMonth(),r=n.getDate();let u;r>=e?u=new Date(a,i+1,e):u=new Date(a,i,e);let s;return t>=e?s=new Date(u.getFullYear(),u.getMonth(),t):s=new Date(u.getFullYear(),u.getMonth()+1,t),{statementDate:u,dueDate:s}}export{$ as a,h as b,z as c,b as d,p as e,W as f,N as g,I as h,E as i,Y as j,P as s,T as v};
