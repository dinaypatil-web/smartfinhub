import{c as h,x as E,z as H,u as B,r,t as f,j as e,S as p,K as y,B as c,C as N,h as w,e as M,f as R}from"./index-CadMXyJB.js";import{B as z}from"./badge-i6nMjZC_.js";import{a as L,f as P}from"./format-RllGV7dv.js";import{c as $}from"./cache-SNmVlzwA.js";import{A as F,a as I,b as O,c as V,d as q,e as K,f as U,g as G}from"./alert-dialog-D5-RVg6R.js";import{T as J,a as Q,b as T,c as a,d as W,e as t}from"./table-BT0d-UrM.js";import{P as b}from"./plus-nRr9gPfm.js";import{S as X}from"./square-pen-YCFt9pMo.js";import{T as Y}from"./trash-2-Co2tl0ej.js";import"./countries-BGn44Cmt.js";/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],ee=h("arrow-down-right",Z);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]],d=h("arrow-left-right",se);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],te=h("arrow-up-right",ae);function ue(){const{user:n,profile:i}=E(),v=H(),{toast:o}=B(),[x,A]=r.useState([]),[D,m]=r.useState(!0),[k,l]=r.useState(!1),[u,j]=r.useState(null);i!=null&&i.default_currency,r.useEffect(()=>{n&&g()},[n]);const g=async()=>{if(n){m(!0);try{const s=await f.getTransactions(n.id);A(s)}catch(s){console.error("Error loading transactions:",s),o({title:"Error",description:"Failed to load transactions",variant:"destructive"})}finally{m(!1)}}},C=async()=>{if(u)try{await f.deleteTransaction(u.id),$.clearPattern("dashboard-"),o({title:"Success",description:"Transaction deleted successfully"}),g()}catch(s){console.error("Error deleting transaction:",s),o({title:"Error",description:"Failed to delete transaction",variant:"destructive"})}finally{l(!1),j(null)}},_=s=>{switch(s){case"income":return e.jsx(ee,{className:"h-4 w-4 text-success"});case"expense":return e.jsx(te,{className:"h-4 w-4 text-danger"});case"transfer":return e.jsx(d,{className:"h-4 w-4 text-primary"});default:return e.jsx(d,{className:"h-4 w-4"})}},S=s=>{switch(s){case"income":return"default";case"expense":return"destructive";default:return"secondary"}};return D?e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsx(p,{className:"h-12 w-64 bg-muted"}),e.jsx(p,{className:"h-96 bg-muted"})]}):e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Transactions"}),e.jsx("p",{className:"text-muted-foreground",children:"View and manage your transactions"})]}),e.jsx(y,{to:"/transactions/new",children:e.jsxs(c,{children:[e.jsx(b,{className:"mr-2 h-4 w-4"}),"Add Transaction"]})})]}),x.length===0?e.jsx(N,{children:e.jsxs(w,{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(d,{className:"h-16 w-16 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No transactions yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Add your first transaction to get started"}),e.jsx(y,{to:"/transactions/new",children:e.jsxs(c,{children:[e.jsx(b,{className:"mr-2 h-4 w-4"}),"Add Transaction"]})})]})}):e.jsxs(N,{children:[e.jsx(M,{children:e.jsx(R,{children:"All Transactions"})}),e.jsx(w,{children:e.jsxs(J,{children:[e.jsx(Q,{children:e.jsxs(T,{children:[e.jsx(a,{children:"Date"}),e.jsx(a,{children:"Type"}),e.jsx(a,{children:"Description"}),e.jsx(a,{children:"Category"}),e.jsx(a,{className:"text-right",children:"Amount"}),e.jsx(a,{className:"text-right",children:"Actions"})]})}),e.jsx(W,{children:x.map(s=>e.jsxs(T,{children:[e.jsx(t,{children:L(s.transaction_date)}),e.jsx(t,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[_(s.transaction_type),e.jsx(z,{variant:S(s.transaction_type),children:s.transaction_type})]})}),e.jsx(t,{className:"max-w-xs",children:e.jsx("div",{className:"break-words line-clamp-2",children:s.description||"-"})}),e.jsx(t,{className:"max-w-xs",children:e.jsx("div",{className:"break-words",children:s.category||"-"})}),e.jsxs(t,{className:`text-right font-semibold ${s.transaction_type==="income"?"text-success":"text-danger"}`,children:[s.transaction_type==="income"?"+":"-",P(Number(s.amount),s.currency)]}),e.jsx(t,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>v(`/transactions/edit/${s.id}`),children:e.jsx(X,{className:"h-4 w-4"})}),e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>{j(s),l(!0)},children:e.jsx(Y,{className:"h-4 w-4 text-danger"})})]})})]},s.id))})]})})]}),e.jsx(F,{open:k,onOpenChange:l,children:e.jsxs(I,{children:[e.jsxs(O,{children:[e.jsx(V,{children:"Delete Transaction"}),e.jsx(q,{children:"Are you sure you want to delete this transaction? This action cannot be undone and will affect account balances."})]}),e.jsxs(K,{children:[e.jsx(U,{children:"Cancel"}),e.jsx(G,{onClick:C,className:"bg-danger text-danger-foreground hover:bg-danger/90",children:"Delete"})]})]})})]})}export{ue as default};
