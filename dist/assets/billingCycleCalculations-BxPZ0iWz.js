function m(r,a){return new Date(r,a+1,0).getDate()}function l(r,a,n){const c=m(r,a);return Math.min(n,c)}function D(r){const a=new Date,n=a.getFullYear(),c=a.getMonth(),o=a.getDate(),s=l(n,c,r);let u,t,e,i;o<s?(t=c-1,u=n,t<0&&(t=11,u--),i=c,e=n):(t=c,u=n,i=c+1,e=n,i>11&&(i=0,e++));const d=l(u,t,r),y=l(e,i,r),g=new Date(u,t,d+1,0,0,0),h=new Date(e,i,y,23,59,59),S=new Date(e,i,y,23,59,59);return{cycleStart:g,cycleEnd:h,statementDate:S}}function f(r,a){const n=new Date,c=n.getFullYear(),o=n.getMonth(),s=n.getDate(),u=l(c,o,a);if(s<=u)return new Date(c,o,u,23,59,59);{let t=o+1,e=c;t>11&&(t=0,e++);const i=l(e,t,a);return new Date(e,t,i,23,59,59)}}function M(r,a,n,c){const{cycleStart:o,cycleEnd:s}=D(c),u=new Set(n.filter(t=>t.transaction_id!==null).map(t=>t.transaction_id));return a.filter(t=>{const e=new Date(t.transaction_date);return e>=o&&e<=s&&!u.has(t.id)}).reduce((t,e)=>e.transaction_type==="expense"||e.transaction_type==="withdrawal"?t+e.amount:(e.transaction_type==="transfer"||e.transaction_type==="credit_card_repayment")&&e.to_account_id===r?t-e.amount:t,0)}function w(r,a){const{cycleStart:n,cycleEnd:c}=D(a);return r.filter(o=>{if(o.status!=="active"||o.remaining_installments<=0)return!1;const s=new Date(o.created_at);return s>=n&&s<=c}).reduce((o,s)=>o+s.monthly_emi,0)}function E(r,a,n,c){const o=M(r,a,n,c),s=w(n,c);return o+s}function _(r,a){const n=new Date,o=f(r,a).getTime()-n.getTime();return Math.ceil(o/(1e3*60*60*24))}function p(r,a){const{cycleStart:n,cycleEnd:c}=D(r),o=f(r,a),s=_(r,a),u=s<0,t=e=>e.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return{cycleStartStr:t(n),cycleEndStr:t(c),dueDateStr:t(o),daysUntilDue:Math.abs(s),isOverdue:u}}export{E as c,p as g};
